<div class="acf-map">
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/drapeau.png" data-lat="47.93127" data-lng="107.42666"></span>
	<span class="marker" data-lat="47.95243" data-lng="107.24332"></span>
	<span class="marker" data-lat="47.92577" data-lng="106.91283"></span>
	<span class="marker" data-lat="47.69636" data-lng="105.94064"></span>
	<span class="marker" data-lat="47.70835" data-lng="102.83604"></span>
	<span class="marker" data-lat="47.19113" data-lng="102.83356"></span>
	<span class="marker" data-lat="47.32020" data-lng="101.65826"></span>
	<span class="marker" data-lat="47.47847" data-lng="101.45743"></span>
	<span class="marker" data-lat="48.69354" data-lng="98.86337"></span>
	<span class="marker" data-lat="48.86491" data-lng="97.17027"></span>
	<span class="marker" data-lat="49.02211" data-lng="95.92970"></span>
	<span class="marker" data-lat="49.01347" data-lng="94.61878"></span>
	<span class="marker" data-lat="49.33731" data-lng="93.13284"></span>
	<span class="marker" data-lat="49.98180" data-lng="92.06592"></span>
	<span class="marker" data-lat="48.40811" data-lng="92.01262"></span>
	<span class="marker" data-lat="48.40475" data-lng="90.86578"></span>
	<span class="marker" data-lat="48.79201" data-lng="89.90799"></span>
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/vodka.png" data-lat="49.03133" data-lng="89.91314"></span>
	<span class="marker" data-lat="50.01339" data-lng="88.66486"></span>
	<span class="marker" data-lat="50.31054" data-lng="87.58273"></span>
	<span class="marker" data-lat="51.79781" data-lng="85.73902"></span>
	<span class="marker" data-lat="53.33721" data-lng="83.77768"></span>
	<span class="marker" data-lat="51.01139" data-lng="81.00203"></span>
	<span class="marker" data-lat="49.18249" data-lng="81.19150"></span>
	<span class="marker" data-lat="47.74233" data-lng="80.64394"></span>
	<span class="marker" data-lat="46.17654" data-lng="80.95201"></span>
	<span class="marker" data-lat="45.39096" data-lng="79.49372"></span>
	<span class="marker" data-lat="44.18743" data-lng="78.57840"></span>
	<span class="marker" data-lat="42.92786" data-lng="79.23868"></span>
	<span class="marker" data-lat="42.47775" data-lng="78.38455"></span>
	<span class="marker" data-lat="42.21062" data-lng="76.85293"></span>
	<span class="marker" data-lat="42.21575" data-lng="75.75472"></span>
	<span class="marker" data-lat="41.76315" data-lng="75.13894"></span>
	<span class="marker" data-lat="41.92607" data-lng="74.51406"></span>
	<span class="marker" data-lat="41.87367" data-lng="73.69888"></span>
	<span class="marker" data-lat="41.89446" data-lng="73.39000"></span>
	<span class="marker" data-lat="41.76380" data-lng="73.22862"></span>
	<span class="marker" data-lat="41.34224" data-lng="72.22978"></span>
	<span class="marker" data-lat="40.53651" data-lng="72.84032"></span>
	<span class="marker" data-lat="40.50359" data-lng="72.83167"></span>
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/ger.png" data-lat="39.54073" data-lng="73.26398"></span>
	<span class="marker" data-lat="38.56090" data-lng="73.59574"></span>
	<span class="marker" data-lat="38.17455" data-lng="73.96684"></span>
	<span class="marker" data-lat="37.75001" data-lng="73.25255"></span>
	<span class="marker" data-lat="37.29729" data-lng="72.97520"></span>
	<span class="marker" data-lat="37.12769" data-lng="72.72870"></span>
	<span class="marker" data-lat="37.00324" data-lng="72.36982"></span>
	<span class="marker" data-lat="36.68213" data-lng="71.76057"></span>
	<span class="marker" data-lat="38.45730" data-lng="70.78819"></span>
	<span class="marker" data-lat="38.62741" data-lng="70.71749"></span>
	<span class="marker" data-lat="38.69579" data-lng="70.48430"></span>
	<span class="marker" data-lat="38.69588" data-lng="70.48421"></span>
	<span class="marker" data-lat="38.58071" data-lng="69.40653"></span>
	<span class="marker" data-lat="38.57174" data-lng="68.80473"></span>
	<span class="marker" data-lat="38.25206" data-lng="67.86954"></span>
	<span class="marker" data-lat="38.20761" data-lng="67.20674"></span>
	<span class="marker" data-lat="38.18458" data-lng="67.17368"></span>
	<span class="marker" data-lat="39.05751" data-lng="65.59730"></span>
	<span class="marker" data-lat="39.77266" data-lng="64.42258"></span>
	<span class="marker" data-lat="41.57073" data-lng="60.66949"></span>
	<span class="marker" data-lat="41.86718" data-lng="60.66204"></span>
	<span class="marker" data-lat="42.26533" data-lng="60.07234"></span>
	<span class="marker" data-lat="42.47115" data-lng="59.62059"></span>
	<span class="marker" data-lat="42.99920" data-lng="58.84425"></span>
	<span class="marker" data-lat="43.72477" data-lng="57.86701"></span>
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/desert.png" data-lat="43.96154" data-lng="57.54596"></span>
	<span class="marker" data-lat="44.87545" data-lng="56.03961"></span>
	<span class="marker" data-lat="45.03709" data-lng="55.75128"></span>
	<span class="marker" data-lat="45.05666" data-lng="55.70006"></span>
	<span class="marker" data-lat="45.33804" data-lng="55.18027"></span>
	<span class="marker" data-lat="44.31520" data-lng="53.56288"></span>
	<span class="marker" data-lat="44.13863" data-lng="52.13884"></span>
	<span class="marker" data-lat="43.57811" data-lng="52.10749"></span>
	<span class="marker" data-lat="43.56929" data-lng="51.79556"></span>
	<span class="marker" data-lat="43.60322" data-lng="51.22015"></span>
	<span class="marker" data-lat="42.09483" data-lng="51.20816"></span>
	<span class="marker" data-lat="41.29810" data-lng="51.02933"></span>
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/boat.png" 	data-lat="39.97673" data-lng="49.44122"></span>
	<span class="marker" data-lat="40.37421" data-lng="49.86443"></span>
	<span class="marker" data-lat="40.41685" data-lng="49.81416"></span>
	<span class="marker" data-lat="40.17802" data-lng="49.47661"></span>
	<span class="marker" data-lat="40.27486" data-lng="48.35456"></span>
	<span class="marker" data-lat="40.73471" data-lng="46.22382"></span>
	<span class="marker" data-lat="41.32710" data-lng="45.07825"></span>
	<span class="marker" data-lat="41.64552" data-lng="45.54423"></span>
	<span class="marker" data-lat="41.62206" data-lng="45.92030"></span>
	<span class="marker" data-lat="41.60638" data-lng="45.93255"></span>
	<span class="marker" data-lat="41.59881" data-lng="45.87878"></span>
	<span class="marker" data-lat="41.68757" data-lng="44.81789"></span>
	<span class="marker" data-lat="41.33388" data-lng="45.06538"></span>
	<span class="marker" data-lat="41.69639" data-lng="44.81693"></span>
	<span class="marker" data-lat="42.02274" data-lng="43.56693"></span>
	<span class="marker" data-lat="42.13300" data-lng="42.98444"></span>
	<span class="marker" data-lat="42.08760" data-lng="42.03472"></span>
	<span class="marker" data-lat="41.52437" data-lng="41.54875"></span>
	<span class="marker" data-lat="41.39670" data-lng="41.42094"></span>
	<span class="marker" data-lat="40.95311" data-lng="39.88340"></span>
	<span class="marker" data-lat="40.45916" data-lng="39.47707"></span>
	<span class="marker" data-lat="40.26518" data-lng="39.48278"></span>
	<span class="marker" data-lat="39.87394" data-lng="39.13036"></span>
	<span class="marker" data-lat="39.93024" data-lng="38.59006"></span>
	<span class="marker" data-lat="39.74636" data-lng="37.02002"></span>
	<span class="marker" data-lat="38.64454" data-lng="34.84303"></span>
	<span class="marker" data-lat="38.63805" data-lng="34.71332"></span>
	<span class="marker" data-lat="39.13210" data-lng="33.34275"></span>
	<span class="marker" data-lat="40.16909" data-lng="31.91964"></span>
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/package.png" data-lat="39.91636" data-lng="32.86296"></span>
	<span class="marker" data-lat="39.91631" data-lng="32.86296"></span>
	<span class="marker" data-lat="39.62406" data-lng="30.82809"></span>
	<span class="marker" data-lat="40.38133" data-lng="28.87928"></span>
	<span class="marker" data-lat="40.28633" data-lng="27.46943"></span>
	<span class="marker" data-lat="40.39656" data-lng="26.92058"></span>
	<span class="marker" data-lat="40.93127" data-lng="26.33176"></span>
	<span class="marker" data-lat="40.84680" data-lng="25.72818"></span>
	<span class="marker" data-lat="41.00845" data-lng="25.14466"></span>
	<span class="marker" data-lat="40.66480" data-lng="23.70156"></span>
	<span class="marker" data-lat="40.55470" data-lng="22.54229"></span>
	<span class="marker" data-lat="41.14686" data-lng="20.76034"></span>
	<span class="marker" data-lat="41.09141" data-lng="20.60853"></span>
	<span class="marker" data-lat="41.34992" data-lng="19.51380"></span>
	<span class="marker" data-lat="41.80984" data-lng="19.63497"></span>
	<span class="marker" data-lat="42.08666" data-lng="19.09795"></span>
	<span class="marker" data-lat="42.51473" data-lng="18.69416"></span>
	<span class="marker" data-lat="42.64250" data-lng="18.11815"></span>
	<span class="marker" data-lat="43.05301" data-lng="17.43573"></span>
	<span class="marker" data-lat="43.51817" data-lng="16.22451"></span>
	<span class="marker" data-lat="43.80585" data-lng="15.96363"></span>
	<span class="marker" data-lat="43.90227" data-lng="15.97622"></span>
	<span class="marker" data-lat="43.90404" data-lng="15.97753"></span>
	<span class="marker" data-lat="44.22046" data-lng="16.05931"></span>
	<span class="marker" data-lat="44.71128" data-lng="15.74412"></span>
	<span class="marker" data-lat="45.68242" data-lng="15.62589"></span>
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/crash.png" data-lat="45.81362" data-lng="15.95893"></span>
	<span class="marker" data-lat="46.44131" data-lng="14.02448"></span>
	<span class="marker" data-lat="46.81046" data-lng="13.50960"></span>
	<span class="marker" data-lat="47.42796" data-lng="13.22404"></span>
	<span class="marker" data-lat="47.81108" data-lng="13.03946"></span>
	<span class="marker" data-lat="47.83001" data-lng="12.72948"></span>
	<span class="marker" data-lat="48.36517" data-lng="10.07264"></span>
	<span class="marker" data-lat="48.36517" data-lng="10.07257"></span>
	<span class="marker" data-lat="48.58733" data-lng="7.68770"></span>
	<span class="marker" data-lat="48.88637" data-lng="2.38710"></span>
	<span class="marker" data-lat="48.11314" data-lng="-1.68137"></span>
	<span class="marker" data-icon="<?= get_template_directory_uri(); ?>/img/icons/drapeau.png" data-lat="48.64494" data-lng="-3.94788"></span>
</div>
<style>
	.acf-map{
		height: <?=  $heightMap  ?>;	
		overflow: hidden;
		width: 100%;
		z-index: 4;
	}
</style>

<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
<script type="text/javascript">
(function($) {

/*
*  render_map
*
*  This function will render a Google Map onto the selected jQuery element
*
*  @type	function
*  @date	8/11/2013
*  @since	4.3.0
*
*  @param	$el (jQuery element)
*  @return	n/a
*/
var directionsDisplay;
var directionsService = new google.maps.DirectionsService();
var map;   
var carte = $('.acf-map'); 	

function render_map( $el ) {

	// var
	var $markers = $el.find('.marker');

	// vars
	var args = {
		zoom		: 16,
		center		: new google.maps.LatLng(0, 0),
		// scrollwheel: false,
		mapTypeId	: google.maps.MapTypeId.HYBRID,
	  // mapTypeControl: false,
    panControl: true,
    panControlOptions: {
        position: google.maps.ControlPosition.LEFT_CENTER
    },
    zoomControl: true,
    zoomControlOptions: {
        position: google.maps.ControlPosition.LEFT_CENTER
    },
    scaleControl: true,  // fixed to BOTTOM_RIGHT
    streetViewControl: false,
    // streetViewControlOptions: {
    //     position: google.maps.ControlPosition.LEFT_CENTER
    // },
	};

	// create map	
	// directionsDisplay = new google.maps.DirectionsRenderer();
	map = new google.maps.Map( $el[0], args);
	// directionsDisplay.setMap(map);

	// add a markers reference
	map.markers = [];

	// Define a symbol using SVG path notation, with an opacity of 1.
	 var lineSymbol = {
	   path: 'M 0,-1 0,1',
	   strokeOpacity: 1,
     strokeColor: 'white',
	   scale: 3
	 }

	poly = new google.maps.Polyline({
	    strokeOpacity: 1,
	    strokeColor: '#B76C34',
	    strokeWeight: 10,
      icons: [{
        icon: lineSymbol,
        offset: '0',
        repeat: '12px'
      }],
  });
  poly.setMap(map);

	// add markers
	$markers.each(function(index){
			if($(this).data('icon') !== undefined) add_marker( $(this), map, $(this).data('icon'));
    	else add_marker( $(this), map);
	});

	// center map
	center_map( map );
	// if(locations !== undefined) calcRoute();
	google.maps.event.addListenerOnce(map, 'idle', function(){
	    carte.addClass('active');
	});
}

/*
*  add_marker
*
*  This function will add a marker to the selected Google Map
*
*  @type	function
*  @date	8/11/2013
*  @since	4.3.0
*
*  @param	$marker (jQuery element)
*  @param	map (Google Map object)
*  @return	n/a
*/

function add_marker( $marker, map, markerIcon) {
	var path = poly.getPath();

	// var
	var latlng = new google.maps.LatLng( $marker.attr('data-lat'), $marker.attr('data-lng') );
	path.push(latlng);

	if(markerIcon !== undefined) {
		// console.log('oui');
		// create marker
		// var image = markerIcon;
		var marker = new google.maps.Marker({
			position	: latlng,
			map			: map,
			icon: markerIcon
		});

		// add to array
		map.markers.push( marker );

		// if marker contains HTML, add it to an infoWindow
		if( $marker.html() )
		{
			// create info window
			var infowindow = new google.maps.InfoWindow({
				content		: $marker.html()
			});

			// show info window when marker is clicked
			google.maps.event.addListener(marker, 'click', function() {

				infowindow.open( map, marker );

			});
		}
	}

}

/*
*  center_map
*
*  This function will center the map, showing all markers attached to this map
*
*  @type	function
*  @date	8/11/2013
*  @since	4.3.0
*
*  @param	map (Google Map object)
*  @return	n/a
*/

function center_map( map ) {

	// vars
	var bounds = new google.maps.LatLngBounds();

	// loop through all markers and create bounds
	$.each( map.markers, function( i, marker ){

		var latlng = new google.maps.LatLng( marker.position.lat(), marker.position.lng() );

		bounds.extend( latlng );

	});

	// only 1 marker?
	if( map.markers.length == 1 )
	{
		// set center of map
	    map.setCenter( bounds.getCenter() );
	    map.setZoom( 16 );
	}
	else
	{
		// fit to bounds
		map.fitBounds( bounds );
	}

}

$(document).ready(function(){

	$('.acf-map').each(function(){
		render_map( $(this) );

	});

});

})(jQuery);
</script>